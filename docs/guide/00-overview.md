# ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏° Module C ‚Äî RESTful API

## ‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏Ç‡∏≠‡∏á Module C ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?

Module C ‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á **Music Album RESTful API** ‡∏î‡πâ‡∏ß‡∏¢ Node.js ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:

> ‡∏™‡∏£‡πâ‡∏≤‡∏á HTTP Server ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö Request ‡∏à‡∏≤‡∏Å Client (‡πÄ‡∏ä‡πà‡∏ô Postman ‡∏´‡∏£‡∏∑‡∏≠ Frontend) ‡πÅ‡∏•‡∏∞‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏î‡πâ‡∏ß‡∏¢ JSON ‡∏ú‡πà‡∏≤‡∏ô **RESTful API** ‡πÇ‡∏î‡∏¢‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• MySQL ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Album ‡πÅ‡∏•‡∏∞ Song

### ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á

| ‡∏Å‡∏•‡∏∏‡πà‡∏° Route | Endpoint | ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ |
|:------------|:---------|:---------|
| **Auth** | `POST /api/login` | ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö ‚Äî ‡∏£‡∏±‡∏ö token ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤ |
| | `POST /api/register` | ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÉ‡∏´‡∏°‡πà |
| | `POST /api/logout` | ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö ‚Äî ‡∏•‡∏ö token |
| **Albums** | `GET /api/albums` | ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏•‡∏ö‡∏±‡πâ‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (Cursor Pagination) |
| | `GET /api/albums/:id` | ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏≠‡∏±‡∏•‡∏ö‡∏±‡πâ‡∏° + ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏•‡∏á |
| | `GET /api/albums/:id/songs` | ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏•‡∏á‡πÉ‡∏ô‡∏≠‡∏±‡∏•‡∏ö‡∏±‡πâ‡∏° |
| | `POST /api/albums` | ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏±‡∏•‡∏ö‡∏±‡πâ‡∏°‡πÉ‡∏´‡∏°‡πà (publisher/admin ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô) |
| | `PUT /api/albums/:id` | ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏≠‡∏±‡∏•‡∏ö‡∏±‡πâ‡∏° (‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á/admin) |
| | `DELETE /api/albums/:id` | ‡∏•‡∏ö‡∏≠‡∏±‡∏•‡∏ö‡∏±‡πâ‡∏° (‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á/admin) |
| **Songs** | `GET /api/songs` | ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏•‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏û‡∏£‡πâ‡∏≠‡∏° search) |
| | `GET /api/songs/:id` | ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏•‡∏á + ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å view |
| | `POST /api/albums/:id/songs` | ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏û‡∏•‡∏á‡πÉ‡∏ô‡∏≠‡∏±‡∏•‡∏ö‡∏±‡πâ‡∏° (‡∏û‡∏£‡πâ‡∏≠‡∏° upload ‡∏£‡∏π‡∏õ) |
| | `POST /api/albums/:id/songs/:songId` | ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏•‡∏á |
| | `PUT /api/albums/:id/songs/order` | ‡∏à‡∏±‡∏î‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÄ‡∏û‡∏•‡∏á‡πÉ‡∏ô‡∏≠‡∏±‡∏•‡∏ö‡∏±‡πâ‡∏° |
| | `DELETE /api/albums/:id/songs/:songId` | ‡∏•‡∏ö‡πÄ‡∏û‡∏•‡∏á (Soft Delete) |
| **Users** | `GET /api/users` | ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ user ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (admin ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô) |
| | `PUT /api/users/:id` | ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô role ‡∏Ç‡∏≠‡∏á user (admin) |
| | `PUT /api/users/:id/ban` | ‡πÅ‡∏ö‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ (admin) |
| | `PUT /api/users/:id/unban` | ‡∏õ‡∏•‡∏î‡πÅ‡∏ö‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ (admin) |
| **Statistics** | `GET /api/statistics?metrics=song` | ‡πÄ‡∏û‡∏•‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏° view_count |
| | `GET /api/statistics?metrics=album` | ‡∏≠‡∏±‡∏•‡∏ö‡∏±‡πâ‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏° total_view_count |
| | `GET /api/statistics?metrics=label` | ‡πÅ‡∏ï‡πà‡∏•‡∏∞ label ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏û‡∏•‡∏á‡πÅ‡∏•‡∏∞ total_view_count |

### ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏î‡πâ‡∏≤‡∏ô Security

- ‡∏ó‡∏∏‡∏Å endpoint (‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô login, register, GET albums, GET songs) ‡∏ï‡πâ‡∏≠‡∏á‡∏™‡πà‡∏á **Token** ‡∏°‡∏≤‡πÉ‡∏ô Header `X-Authorization`
- Password ‡∏ï‡πâ‡∏≠‡∏á hash ‡∏î‡πâ‡∏ß‡∏¢ **bcrypt** ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÄ‡∏™‡∏°‡∏≠
- ‡∏£‡∏∞‡∏ö‡∏ö Role: `admin` ‚Üí `publisher` ‚Üí `user` ‚Äî ‡πÅ‡∏ï‡πà‡∏•‡∏∞ role ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô

## ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°

| ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠ | ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô | ‡πÉ‡∏ä‡πâ‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£ |
|:----------|:--------:|:---------|
| [Node.js](https://nodejs.org/) | v18+ | Runtime ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏±‡∏ô JavaScript ‡∏ö‡∏ô Server |
| [XAMPP](https://www.apachefriends.org/) | ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î | MySQL + phpMyAdmin |
| [Postman](https://www.postman.com/downloads/) | ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î | ‡∏ó‡∏î‡∏™‡∏≠‡∏ö API |
| [VS Code](https://code.visualstudio.com/) | ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î | Code Editor |

## Tech Stack ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ

| Package | ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà |
|:--------|:-------|
| `express` | HTTP Server Framework |
| `mysql2` | ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ MySQL (Promise-based) |
| `dotenv` | ‡∏≠‡πà‡∏≤‡∏ô Environment Variables ‡∏à‡∏≤‡∏Å `.env` |
| `cors` | ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï Cross-Origin Request |
| `bcryptjs` | Hash ‡πÅ‡∏•‡∏∞ Verify Password |
| `multer` | ‡∏£‡∏±‡∏ö multipart/form-data (file upload) |
| `nodemon` | Auto-restart server ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÇ‡∏Ñ‡πâ‡∏î (dev only) |

## ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡πá‡∏Ñ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á

```
Demo Module C/
‚îú‚îÄ‚îÄ .env                    # Environment Variables (DB, PORT)
‚îú‚îÄ‚îÄ app.js                  # Entry point ‚Äî ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Express + Middleware + Routes
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ database.js         # MySQL Connection Pool
‚îú‚îÄ‚îÄ middleware/
‚îÇ   ‚îú‚îÄ‚îÄ auth.js             # ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Token + Role
‚îÇ   ‚îî‚îÄ‚îÄ upload.js           # ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Multer (file upload)
‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îú‚îÄ‚îÄ auth.js             # Login, Register, Logout
‚îÇ   ‚îú‚îÄ‚îÄ albums.js           # CRUD Albums
‚îÇ   ‚îú‚îÄ‚îÄ songs.js            # CRUD Songs
‚îÇ   ‚îú‚îÄ‚îÄ users.js            # User Management (Admin)
‚îÇ   ‚îî‚îÄ‚îÄ statistics.js       # Statistics
‚îú‚îÄ‚îÄ uploads/                # ‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà upload ‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤
‚îî‚îÄ‚îÄ module_c_db.sql         # SQL ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
```

## ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ

‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏∑‡πà‡∏≠ `04_module_c` ‡∏°‡∏µ 6 ‡∏ï‡∏≤‡∏£‡∏≤‡∏á:

```
users          ‚Äî ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ (username, password_hash, role, token)
albums         ‚Äî ‡∏≠‡∏±‡∏•‡∏ö‡∏±‡πâ‡∏°‡πÄ‡∏û‡∏•‡∏á (title, artist, genre, publisher_id)
songs          ‚Äî ‡πÄ‡∏û‡∏•‡∏á (title, lyrics, track_order, deleted_at)
labels         ‚Äî ‡∏õ‡πâ‡∏≤‡∏¢‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡πÄ‡∏û‡∏•‡∏á ‡πÄ‡∏ä‡πà‡∏ô Pop, Rock, Jazz
song_labels    ‚Äî ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° songs ‡∏Å‡∏±‡∏ö labels (many-to-many)
user_view_logs ‚Äî ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ß‡πà‡∏≤ user ‡∏Ñ‡∏ô‡πÑ‡∏´‡∏ô‡∏î‡∏π‡πÄ‡∏û‡∏•‡∏á‡∏≠‡∏∞‡πÑ‡∏£
```

## ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á API

```
Client (Postman / Frontend)
         ‚îÇ
         ‚îÇ  HTTP Request + X-Authorization Header
         ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ           Express App               ‚îÇ
    ‚îÇ                                     ‚îÇ
    ‚îÇ  Middleware: CORS, JSON Parser      ‚îÇ
    ‚îÇ         ‚îÇ                           ‚îÇ
    ‚îÇ  Middleware: auth.js (‡∏ï‡∏£‡∏ß‡∏à Token)  ‚îÇ
    ‚îÇ         ‚îÇ                           ‚îÇ
    ‚îÇ  Route Handler (albums.js ‡∏Ø‡∏•‡∏Ø)     ‚îÇ
    ‚îÇ         ‚îÇ                           ‚îÇ
    ‚îÇ  MySQL Query (mysql2)               ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚îÇ  JSON Response
         ‚ñº
      Client
```

::: tip üí° ‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏ú‡∏•
‡πÅ‡∏ï‡πà‡∏•‡∏∞ Step ‡∏à‡∏∞‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ **‡∏ó‡∏§‡∏©‡∏é‡∏µ‡∏Å‡πà‡∏≠‡∏ô** ‡πÅ‡∏•‡πâ‡∏ß **‡∏•‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏±‡∏ô‡∏ó‡∏µ** ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ Postman ‡∏ó‡∏∏‡∏Å Step ‡∏≠‡∏¢‡πà‡∏≤‡∏Ç‡πâ‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö ‚Äî ‡∏Å‡∏≤‡∏£‡πÄ‡∏´‡πá‡∏ô‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏£‡∏¥‡∏á‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÑ‡∏î‡πâ‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏ß‡πà‡∏≤‡∏≠‡πà‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏°‡∏≤‡∏Å
:::
